---
allowed-tools: Bash(gh issue view:*), Bash(gh issue edit:*)
description: 不足情報を対話的に埋めてIssue内容を充実化するコマンド
---

## Context

- Issue詳細: !`gh issue view $ARGUMENTS --json number,title,body,author,state,labels,comments,milestone,assignees,url`
- Issueコメント履歴: !`gh issue view $ARGUMENTS --comments`

## Your task

GitHub Issue #$ARGUMENTS の内容を対話的に充実させてください。

### 充実化プロセス

#### フェーズ1: 現状分析

1. **Issue内容の評価**
   - タイトルの明確性を確認
   - 本文の情報を5つの観点で評価:
     - [ ] **背景・動機（Why）**: なぜこのIssueが必要か
     - [ ] **現状の問題（What）**: 何が問題なのか、再現手順
     - [ ] **期待する結果（Goal）**: どうなれば完了か
     - [ ] **制約条件（Constraints）**: 技術的制約、期限、スコープ
     - [ ] **関連情報（References）**: 関連Issue、PR、ドキュメント
   - コメントから読み取れる追加情報を抽出

2. **不足情報の特定**
   - 上記5観点で不足しているセクションをリスト化
   - 各項目の充実度を以下で評価:
     - ✅ 十分な情報がある
     - ⚠️ 一部情報があるが不十分
     - ❌ 情報が不足している

3. **分析結果の提示**
   - ユーザーに現在の充実度を表示
   - 不足している情報の優先度を説明

#### フェーズ2: 対話的な情報収集

不足している情報について、優先度順にユーザーに質問します。

**質問の優先順位**:

1. **背景・動機（Why）** - 最優先
   - 質問例: 「このIssueを作成した背景や動機を教えてください。どんな状況でこの問題に気づきましたか？」
   - この情報がないと解決の方向性が定まりません

2. **期待する結果（Goal）** - 最優先
   - 質問例: 「このIssueが完了したとき、どのような状態になっていることを期待しますか？」
   - 質問例: 「具体的な終了条件はありますか？どうなれば『完了』と言えますか？」
   - この情報がないと完了判定ができません

3. **現状の問題（What）** - 高優先
   - 質問例: 「現在どのような問題が起きていますか？」
   - 質問例: 「再現手順があれば教えてください。」
   - この情報がないと問題の本質が不明確です

4. **制約条件（Constraints）** - 中優先
   - 質問例: 「技術的な制約はありますか？（使用できるライブラリ、互換性など）」
   - 質問例: 「期限やスコープの制限はありますか？」
   - この情報がないと実現可能性の検討が不十分です

5. **関連情報（References）** - 低優先
   - 質問例: 「関連するIssue、PR、ドキュメント、参考URLなどはありますか？」
   - あると理解が早まりますが、なくても進められます

**質問のルール**:
- 1回につき1〜2つの質問に絞る（認知負荷を下げる）
- オープンエンドな質問から始める
- 既存のIssue本文やコメントから推測できる内容は「〜という理解で合っていますか？」と確認形式で提示
- ユーザーが「わからない」「あとで書く」と回答した場合は、その旨を記録して次の質問へ進む

#### フェーズ3: 情報の統合と確認

1. **情報の統合**
   - 元のIssue本文の内容を尊重（削除しない）
   - 不足していた情報を適切なセクションに追加
   - コメントに散らばった情報を本文に集約（重複は削除）
   - タイトルが曖昧な場合は改善提案を行う

2. **進捗の可視化**
   - 各質問の回答を受け取るたびに、現在の充実度を更新して表示
   - 例: 「背景 ✅ / 問題 ✅ / ゴール ⚠️ / 制約 ❌ / 関連 ❌」

3. **最終確認と更新**
   - すべての情報を統合した新しいIssue本文を提示
   - 変更内容をdiff形式またはセクション別に明示
   - ユーザーの承認を得てから `gh issue edit $ARGUMENTS --body "..."` で更新

#### フェーズ4: 次のステップの提案

Issue内容を充実化した後、次のアクションを提案します:

- **Issueを構造化したい場合**: `/format-issue $ARGUMENTS` で3セクション形式に整形
- **すぐに実装を始めたい場合**: `/fix-issue $ARGUMENTS` で実装開始
- **他に充実化したいIssueがある場合**: 次のIssue番号を指定して再度実行

## 重要な注意事項

- **対話を重視**: 推測せず、不明な点は必ずユーザーに確認する
- **段階的に進める**: 一度にすべてを聞かず、優先度順に1〜2項目ずつ質問
- **既存情報を尊重**: 元のIssue本文やコメントの内容を削除しない
- **認知負荷を下げる**: 質問は簡潔に、選択肢を提示する場合は3〜5個程度に絞る
- **更新前に確認**: 必ずユーザーの承認を得てからIssueを更新する
- **日本語で対話**: すべての質問と説明は日本語で行う

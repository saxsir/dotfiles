---
allowed-tools: Bash(gh issue view:*), Bash(gh issue edit:*)
description: Formats a GitHub Issue description into a structured template with Background (Why), Goals (Solution), and Related Information sections. Use when the user wants to restructure an issue or mentions formatting issue descriptions.
---

## Context

- Issue details: !`gh issue view $ARGUMENTS --json number,title,body,author,state,labels,comments,url`
- Closed by (if any): !`gh issue view $ARGUMENTS --json closedByPullRequestsReferences`

## あなたのタスク

GitHub Issue #$ARGUMENTS の説明を、背景（Why）、ゴール（Solution）、関連情報の3セクションからなる構造化されたテンプレートにフォーマットしてください。

## フォーマット仕様

対象となる形式は3つの主要セクションを持ちます：

```markdown
## 背景・解決したい課題 (Why)
<!-- このIssueを書くに至った状況・条件を説明してください -->
<!-- 背景から導かれる問題やアイデアを記載してください -->

[ここに背景と課題を記載]

## 終了条件・ゴール（Solution）
<!-- このIssueが完了したと言える状態を具体的に記載してください -->
<!-- ※1イテレーション（2週間）で終わらない場合は子Issueに分けましょう -->

[ここにゴールを記載]

## 関連情報
<!-- 関連するIssue、PR、ドキュメント、参考資料などがあれば記載してください -->

[ここに関連情報を記載]
```

## フォーマットワークフロー

進捗チェックリストをコピーして追跡してください：

```
進捗:
- [ ] ステップ1: 現在のissue内容を分析
- [ ] ステップ2: 各セクションの情報を抽出
- [ ] ステップ3: 不足している情報を特定
- [ ] ステップ4: 構造化された形式にコンテンツを変換
- [ ] ステップ5: フォーマット済みバージョンをユーザーに提示
- [ ] ステップ6: ユーザーの承認を得てissueを更新
```

### ステップ1: 現在のissue内容を分析

**issueを徹底的に確認:**
- コンテキストからissue本文を読む
- 追加の文脈についてすべてのコメントを確認
- 現在の構造と構成を注記
- すでに存在する情報を特定

### ステップ2: 各セクションの情報を抽出

**3つのセクションにコンテンツをマッピング:**

**セクション1 - 背景・解決したい課題（Why）:**
- なぜこのissueが作成されたのか？
- 背景となる文脈は何か？
- 解決すべき問題は何か？
- このissueの動機は何か？

**セクション2 - 終了条件・ゴール（Solution）:**
- 「完了」とはどのような状態か？
- どのような具体的な成果が期待されるか？
- 成功はどのように測定されるか？
- どのような成果物が必要か？

**セクション3 - 関連情報（Related Information）:**
- 関連するissue（#番号リンク付き）
- 関連するpull request
- ドキュメントリンク
- 外部参照
- 設計ドキュメントや仕様書

### ステップ3: 不足している情報を特定

**各セクションの完全性を確認:**

- ✅ **十分**: セクションに明確で詳細な情報がある
- ⚠️ **部分的**: 一部情報は存在するがより詳細が必要
- ❌ **不足**: セクションに必要な情報が欠けている

**情報が不足している場合:**
- ユーザーに不足している詳細を提供するよう依頼
- またはユーザーが後で記入することを希望する場合は `[あとで書く]` プレースホルダーで印を付ける

### ステップ4: 構造化された形式にコンテンツを変換

**テンプレートに再構成:**

1. 背景と動機を最初のセクション（Why）に配置
2. ゴールと成功基準を2番目のセクション（Solution）に配置
3. リンクと参照を3番目のセクション（Related Information）に配置
4. すべての元の情報を保持（コンテンツを削除しない）
5. 全体を通して日本語を維持
6. 既存のリンクとissue参照を保持

**変換例:**

**変更前（非構造化）:**
```
ログイン画面が遅い。ユーザーから苦情が来ている。
APIレスポンスを改善したい。
参考: #45, https://example.com/perf-guide
```

**変更後（構造化）:**
```markdown
## 背景・解決したい課題 (Why)
ログイン画面の表示に時間がかかり、ユーザーから苦情が来ている。
現状では初回ログイン時に3秒以上かかることがある。

## 終了条件・ゴール（Solution）
- ログイン画面の表示時間を1秒以内に短縮する
- APIレスポンス時間を改善する
- ユーザー体験を向上させる

## 関連情報
- 関連Issue: #45
- 参考資料: https://example.com/perf-guide
```

### ステップ5: フォーマット済みバージョンをユーザーに提示

**変換されたコンテンツを表示:**
- 完全にフォーマットされたissue説明を表示
- 元のものから何が変わったかを強調
- ユーザーの入力が必要なセクション（`[あとで書く]` プレースホルダー）を指摘

**レビューを依頼:**
- 「このフォーマットで問題ないでしょうか？」
- ユーザーが変更や追加を要求できるようにする
- ユーザーが承認するまで更新は行われないことを明確にする

### ステップ6: ユーザーの承認を得てissueを更新

**ユーザーの承認後:**
```bash
gh issue edit $ARGUMENTS --body "<formatted content>"
```

**成功を確認:**
- 更新が正常に完了したことを確認
- ユーザーが確認できるようにissue URLを提供
- フォーマットが完了したことを注記

## 重要な注意事項

- **すべての情報を保持**: 元のissueからコンテンツを削除しない
- **ユーザーの承認が必要**: 更新前に必ず確認を得る
- **正確な理解**: 分類が不明確な場合はユーザーに尋ねる
- **日本語**: すべてのコンテンツを日本語で維持
- **gh CLIを使用**: `gh issue edit` コマンドを使用してissueを更新
- **不足情報を優雅に処理**: ユーザーが後で追加する情報には `[あとで書く]` を使用
